head(mergedData)
head(gdpData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="X.3")
dim(mergedData)
summary(mergedData)
head(mergedData)
md2 <- mergedData[order(-mergedData$X,1),]
md2 <- mergedData[order(-mergedData$X.1),]
head(md2,13)
md2[13,]
md2[13,"Table.Name"]
md2[13:,"Table.Name"]
md2[,"Table.Name"]
md2[13,"Table.Name"]
head(md2,13)
str(md2)
cl;ear
clear
cls
tapply(mergedData$X.1, mergedData$Income.Group, mean)
download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv",destfile="C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv", method="curl")
download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv",destfile="C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data2.csv", method="curl")
gdpData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv", skip=4);
eduData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data2.csv");
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="X.3")
md2 <- mergedData[order(-mergedData$X.1),]
head(md2)
tapply(mergedData$X.1, mergedData$Income.Group, mean)
install.packages("plyr")
library(plyer)
library(plyr)
arrange(mergedData, desc(X.1))
md2 <- arrange(mergedData, desc(X.1))
head(md2,134)
head(md2,13)
md2 <- arrange(mergedData, X.1)
head(md2,15)
arrange(mergedData, desc(X.1))
dim(mergedData)
summary(mergedData)
str(mergedData)
tapply(mergedData$X.1, mergedData$Income.Group, mean)
tapply(mergedData$X.1, mergedData$Income.Group, mean, na.rm=TRUE)
tapply(mergedData$X.1, mergedData$Income.Group, mean,)
df[,c("A","B","E")]
mergedData[,c("X.1","Income.Group")]
mergedData[,c("Table.Name,", X.1","Income.Group")]
mergedData[,c("Table.Name,","X.1","Income.Group")]
mergedData[,c("Table.Name","X.1","Income.Group")]
naRemoved <- mergedData[,c("Table.Name","X.1","Income.Group")]
na.omit(naRemoved)
which(naRemoved)
naRemoved[complete.cases(naRemoved)]
naRemoved[complete.cases(naRemoved),]
naRemoved[naRemoved[,X.1>1],]
naRemoved[naRemoved[,"X.1">1],]
naRemoved[naRemoved$X.1 >= 1,]
naRemoved[as.numeric(naRemoved$X.1) >= 1,]
dim(mergedData)
sapply(md2, function(cl) list(means=mean(cl,na.rm=TRUE)))
sapply(md2["X.1"], function(cl) list(means=mean(cl,na.rm=TRUE)))
head(md2, 15)
naRemoved <- mergedData[,c("Table.Name","X.1","Income.Group")]
head(naRemoved)
str(naRemoved)
dim(naRemoved)
naRemoved[X.1]
naRemoved[,c("X.1")]
gdpData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv",header=FALSE)
head(gdpData)
dim(gdpData)
eduData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data2.csv");
dim(eduData)
head(gdpData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V2")
dim(mergedData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V4")
dim(mergedData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V4", all=TRUE)
dim(mergedData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V4")
tapply(mergedData$X.1, mergedData$Income.Group, mean)
tapply(mergedData$V4, mergedData$Income.Group, mean)
head(mergedData)
head(mergedData,15)
md2 <- arrange(mergedData, desc(V2))
head(md2,15)
head(md2,13)
tapply(mergedData$V2, mergedData$Income.Group, mean)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V4", sort=F, all=F, all.y=T)
head(mergedData)
head(mergedData,15)
md2 <- arrange(mergedData, desc(V2))
head(mergedData)
head(mergedData,15)
tapply(mergedData$V2, mergedData$Income.Group, mean)
download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv",destfile="C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv", method="curl")
gdpData0 <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv");
gdpData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv");
head(gdpData)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="V4", sort=F, all=F)
mergedData <- merge(eduData, gdpData, by.x="Short.Name", by.y="X.2", sort=F, all=F)
dim(mergedData)
dim(mergedData)
mergedData <- merge(gdpData, eduData, by.x="V4", by.y="Short.Name", sort=F, all=F)
mergedData <- merge(gdpData, eduData, by.x="X.2", by.y="Short.Name", sort=F, all=F)
dim(mergedData)
head(mergedData)
mergedData[5,194]
mergedData[5:194]
mergedData[5:194,]
filteredData <- mergedData[5:194,]
dims(filteredData)
dim(filteredData)
dim(mergedData)
dim(mergedData)
head(filteredData)
head(filteredData,15)
head(gdpData)
filteredData[,c("Gross.domestic.product.2012")]
tapply(filteredData$Gross.domestic.product.2012, filteredData$Income.Group, mean)
dims(filteredData)
filteredData[,c("Gross.domestic.product.2012")]
head(filteredData,15)
filteredData[,c("Table.Name", "Gross.domestic.product.2012","Income.Group")
)
smallData = filteredData[,c("Table.Name", "Gross.domestic.product.2012","Income.Group")]
head(smallData)
str(smallData)
tapply(filteredData$Gross.domestic.product.2012, filteredData$Income.Group, mean)
dim(mergedData)
GDP<-read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv")
ED<-read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data2.csv")
gdpdata<-GDP[5:194,c(1,2,4,5)]
str(gdpdata)
names(gdpdata)<-c("CountryCode","GDP.ranking","Short.Name","GDP")
str(gdpdata)
gdpdata[,2]<-as.numeric(as.character(gdpdata[,2]))
str(gdpdata)
mydata<-merge(ED,gdpdata,by.x="CountryCode",by.y="CountryCode",all=TRUE)
str(mydata)
mydata[order(-mydata$GDP.ranking),]
md2 <- mydata[order(-mydata$GDP.ranking),]
dim(md2)
dim(mydata)
head(md2, 15)
tapply(mydata$GDP.ranking, mydata$Income.Group, mean)
head(gdpdata)
mydata<-merge(ED,gdpdata,x.by="Short.Name",y.by="Short.Name",all=TRUE)
head(mydata)
dim(mydata)
gdpData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv");
eduData <- read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data2.csv");
head(gdpData)
head(eduData)
head(eduData,15)
View(GDP)
View(GDP)
GDP<-read.csv("C:/Users/Nate/SkyDrive/Documents/03_GettingAndCleaningData/W3.Q3.data1.csv")
View(GDP)
View(gdpData)
gdpdata<-GDP[5:194,c(1,2,4,5)]
View(gdpData)
names(gdpdata)<-c("CountryCode","GDP.ranking","Short.Name","GDP")
View(gdpData)
head(gdpData)
set.seed(1)
rpois(5, 2)
rpval <- rpois(5,2)
rpval
set.seed(1)
rpval <- rpois(5,2)
rpval
class(rpval)
set.seed(10)
x <- rbinom(10, 10, 0.5)
e <- rnorm(10, 0, 20)
y <- 0.5 + 2 * x + e
y
plot(y)
help(rbinom)
plot(x)
plot(e)
plot(y)
library(datasets)
Rprof()
fit <- lm(y ~ x1 + x2)
library(ggplot2)
str(mpg)
data(mpg)
install.packages("ggplot2")
library(ggplot2)
str(mpg)
qplot(displ, hwy, data=mpg)
qplot(displ, hwy, data=mpg, color=drv)
qplot(displ, hwy, data=mpg, geom=(c"pint","smooth"))
qplot(displ, hwy, data=mpg, geom=(c("point","smooth"))
qplot(displ, hwy, data=mpg, geom=(c("point","smooth")))
qplot(displ, hwy, data=mpg, geom=c("point","smooth"))
qplot(hwy, data=mpg,fill=drv)
qplot(hwy, data=mpg, facets=drv~.,binwidth=2)
source('~/.active-rstudio-document', echo=TRUE)
qplot(displ,hwy, data=mpg, facets=.~drv)
library(lattice)
library(datasets)
xyplot(Ozone~Wind, data=airquality)
chart_val <- xyplot(Ozone~Wind, data=airquality)
class(chart_val)
chart_val <- xyplot(Ozone~Wind, data=airquality)
class(chart_val)
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each=50)
y <- x+4-f*x+rnorm(100, sd=0.5)
f <- factor(f, labels=c("Group 1", "Group 2"))
xyplot(y~x|f,layout=c(2,1)) # plot with two panels
xyplot(y~x|f, panel = function(x,y,...) {
panel.xyplot(x,y,...)
panel.abline(h=median(y), lty=2)
})
xyplot(y~x|f, panel = function(x,y,...) {
panel.xyplot(x,y,...)
lmline(x,y, col=2)
})
xyplot(y~x|f, panel = function(x,y,...) {
panel.xyplot(x,y,...)
panel.lmline(x,y, col=2)
})
library(nlme)
library(lattice)
xyplot(weight ~ Time | Diet, BodyWeight)
library(lattice)
library(datasets)
data(airquality)
p <- xyplot(Ozone ~ Wind | factor(Month), data = airquality)
print(p)
library(datasets)
data(airquality)
airquality = transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
data(airquality)
qplot(Wind, Ozone, data = airquality, facets = . ~ factor(Month))
qplot(Wind, Ozone, data = airquality, geom = "smooth")
qplot(Wind, Ozone, data = airquality)
library(ggplot2)
g <- ggplot(movies, aes(votes, rating))
print(g)
g + geom_line()
qplot(votes, rating, data = movies)
qplot(votes, rating, data = movies) + geom_smooth()
qplot(votes, rating, data = movies, panel = panel.loess)
qplot(votes, rating, data = movies, smooth = "loess")
plot(votes, rating, data = movies) + stats_smooth("loess")
plot(votes, rating, data = movies)
library(ggplot2)
plot(votes, rating, data = movies)
plot(votes, rating, data = movies) + stats_smooth("loess")
qplot(votes, rating, data = movies) + geom_smooth()
# plot6.R - this plots the PM[2.5] Emmission totals for all Vehical related sources in Baltimore vs Las Angeles County from 1999-2008
setwd("F:/Dogbert/Coursera/DataScience/04_ExploritoryDataAnalysis/W3")
library(ggplot2)
download_file_name <- 'https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip'
raw_data_file_name <- 'W3.Project2.Data.zip'
if(!file.exists(raw_data_file_name)) {
download.file(download_file_name, destfile=raw_data_file_name, method='curl')
unzip(raw_data_file_name)
data_file_name <- 'summarySCC_PM25.rds'
code_file_name <- 'Source_Classification_Code.rds'
NEI <- readRDS(data_file_name)
SCC <- readRDS(code_file_name)
} else {
print("Data downloaded and extracted. Check NEI and SCC for data records.")
}
# pop this sucker int a data table for easy grouping
library(data.table)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
# use data.table to group by year summing the total Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year <- baltimore_vs_lac_emissions_for_vehicles[,list(Emissions=sum(Emissions)), by=c('year','fips')]
# lets put some rational names on the data instead of the fips number =P
baltimore_vs_lac_emissions_for_vehicles_by_year$fips_name <- unlist(lapply(baltimore_vs_lac_emissions_for_vehicles_by_year$fips, function(x) if (x == "06037") {"Los Angeles County"} else {"Baltimore"}))
str(baltimore_vs_lac_emissions_for_vehicles_by_year)
## Question 6: Compare emissions from motor vehicle sources in Baltimore City with emissions from motor
## vehicle sources in Los Angeles County, California (fips == "06037").
## Which city has seen greater changes over time in motor vehicle emissions?
# save it to a 480x960 pixel png file
small_data_png_file_name = "plot6.png"
png(height=480, width=960, file=small_data_png_file_name)
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
facet_grid(. ~ fips) +
geom_smooth(method=lm) + ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
# close png file
dev.off()
## Answer It appears that the PM[2.5] Emissions for vehicles in Baltimore have decreased from 1999-2008
# pop this sucker int a data table for easy grouping
library(data.table)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
data_file_name <- 'summarySCC_PM25.rds'
code_file_name <- 'Source_Classification_Code.rds'
NEI <- readRDS(data_file_name)
SCC <- readRDS(code_file_name)
# pop this sucker int a data table for easy grouping
library(data.table)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
# use data.table to group by year summing the total Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year <- baltimore_vs_lac_emissions_for_vehicles[,list(Emissions=sum(Emissions)), by=c('year','fips')]
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
facet_grid(. ~ fips) +
geom_smooth(method=lm) + ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
# lets put some rational names on the data instead of the fips number =P
baltimore_vs_lac_emissions_for_vehicles_by_year$fips_name <- unlist(lapply(baltimore_vs_lac_emissions_for_vehicles_by_year$fips, function(x) if (x == "06037") {"Los Angeles County"} else {"Baltimore"}))
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
facet_grid(. ~ fips_name) +
geom_smooth(method=lm) + ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
?lag
baltimore_vs_lac_emissions_for_vehicles_by_year$percent_change <- baltimore_vs_lac_emissions_for_vehicles_by_year/lag(baltimore_vs_lac_emissions_for_vehicles_by_year,-1) - 1
baltimore_vs_lac_emissions_for_vehicles_by_year$date <- as.Date(as.character(baltimore_vs_lac_emissions_for_vehicles_by_year$year),format="%Y")
baltimore_vs_lac_emissions_for_vehicles_by_year
baltimore_vs_lac_emissions_for_vehicles_by_year_ts <- xts(baltimore_vs_lac_emissions_for_vehicles_by_year$Emissions,baltimore_vs_lac_emissions_for_vehicles_by_year$date)
library(xts)
# make a time series with date, fips_name, Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year_ts <- xts(baltimore_vs_lac_emissions_for_vehicles_by_year$Emissions,baltimore_vs_lac_emissions_for_vehicles_by_year$date)
baltimore_vs_lac_emissions_for_vehicles_by_year_ts
baltimore_vs_lac_emissions_for_vehicles_by_year$percent_change <- baltimore_vs_lac_emissions_for_vehicles_by_year/lag(baltimore_vs_lac_emissions_for_vehicles_by_year,-1) - 1
baltimore_vs_lac_emissions_for_vehicles_by_year_ts$percent_change <- baltimore_vs_lac_emissions_for_vehicles_by_year_ts/lag(baltimore_vs_lac_emissions_for_vehicles_by_year_ts,-1) - 1
baltimore_vs_lac_emissions_for_vehicles_by_year
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) + ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions))
g1 +
geom_point()
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
coord_trans(y = "log10") +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
scale_y_log10() +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*')'))
# plot6.R - this plots the PM[2.5] Emmission totals for all Vehical related sources in Baltimore vs Las Angeles County from 1999-2008
setwd("F:/Dogbert/Coursera/DataScience/04_ExploritoryDataAnalysis/W3")
library(ggplot2)
download_file_name <- 'https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip'
raw_data_file_name <- 'W3.Project2.Data.zip'
if(!file.exists(raw_data_file_name)) {
download.file(download_file_name, destfile=raw_data_file_name, method='curl')
unzip(raw_data_file_name)
data_file_name <- 'summarySCC_PM25.rds'
code_file_name <- 'Source_Classification_Code.rds'
NEI <- readRDS(data_file_name)
SCC <- readRDS(code_file_name)
} else {
print("Data downloaded and extracted. Check NEI and SCC for data records.")
}
# pop this sucker int a data table for easy grouping
library(data.table)
library(xts)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
# use data.table to group by year summing the total Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year <- baltimore_vs_lac_emissions_for_vehicles[,list(Emissions=sum(Emissions)), by=c('year','fips')]
# lets put some rational names on the data instead of the fips number =P
baltimore_vs_lac_emissions_for_vehicles_by_year$fips_name <- unlist(lapply(baltimore_vs_lac_emissions_for_vehicles_by_year$fips, function(x) if (x == "06037") {"Los Angeles County"} else {"Baltimore"}))
# set the year to a date so we can do some time series lag calculations
baltimore_vs_lac_emissions_for_vehicles_by_year$date <- as.Date(as.character(baltimore_vs_lac_emissions_for_vehicles_by_year$year),format="%Y")
# make a time series with date, fips_name, Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year_ts <- xts(baltimore_vs_lac_emissions_for_vehicles_by_year$Emissions,baltimore_vs_lac_emissions_for_vehicles_by_year$date)
baltimore_vs_lac_emissions_for_vehicles_by_year_ts$percent_change <- baltimore_vs_lac_emissions_for_vehicles_by_year_ts/lag(baltimore_vs_lac_emissions_for_vehicles_by_year_ts,-1) - 1
## Question 6: Compare emissions from motor vehicle sources in Baltimore City with emissions from motor
## vehicle sources in Los Angeles County, California (fips == "06037").
## Which city has seen greater changes over time in motor vehicle emissions?
# save it to a 480x960 pixel png file
small_data_png_file_name = "plot6.png"
png(height=480, width=960, file=small_data_png_file_name)
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
scale_y_log10() +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*') *log scale'))
# close png file
dev.off()
## Answer It appears that the PM[2.5] Emissions for vehicles in Baltimore have decreased from 1999-2008
source('F:/Dogbert/Coursera/DataScience/04_ExploritoryDataAnalysis/W3/plot6.R', echo=TRUE)
# plot6.R - this plots the PM[2.5] Emmission totals for all Vehical related sources in Baltimore vs Las Angeles County from 1999-2008
setwd("F:/Dogbert/Coursera/DataScience/04_ExploritoryDataAnalysis/W3")
library(ggplot2)
download_file_name <- 'https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip'
raw_data_file_name <- 'W3.Project2.Data.zip'
if(!file.exists(raw_data_file_name)) {
download.file(download_file_name, destfile=raw_data_file_name, method='curl')
unzip(raw_data_file_name)
data_file_name <- 'summarySCC_PM25.rds'
code_file_name <- 'Source_Classification_Code.rds'
NEI <- readRDS(data_file_name)
SCC <- readRDS(code_file_name)
} else {
print("Data downloaded and extracted. Check NEI and SCC for data records.")
}
# pop this sucker int a data table for easy grouping
library(data.table)
library(xts)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
# use data.table to group by year summing the total Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year <- baltimore_vs_lac_emissions_for_vehicles[,list(Emissions=sum(Emissions)), by=c('year','fips')]
# lets put some rational names on the data instead of the fips number =P
baltimore_vs_lac_emissions_for_vehicles_by_year$fips_name <- unlist(lapply(baltimore_vs_lac_emissions_for_vehicles_by_year$fips, function(x) if (x == "06037") {"Los Angeles County"} else {"Baltimore"}))
## Question 6: Compare emissions from motor vehicle sources in Baltimore City with emissions from motor
## vehicle sources in Los Angeles County, California (fips == "06037").
## Which city has seen greater changes over time in motor vehicle emissions?
# save it to a 480x960 pixel png file
small_data_png_file_name = "plot6.png"
png(height=480, width=480, file=small_data_png_file_name)
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
scale_y_log10() +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Relative Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*') *log scale'))
# close png file
dev.off()
## Answer It appears that Baltimore had the greatest change. It decreased by a larger ammount in relative terms to the Los Angeles County increase.
## To show this easily I graphed each to log scale as the absolute change in Los Angeles County was greater, but it's percentage change was smaller.
# plot6.R - this plots the PM[2.5] Emmission totals for all Vehical related sources in Baltimore vs Las Angeles County from 1999-2008
setwd("F:/Dogbert/Coursera/DataScience/04_ExploritoryDataAnalysis/W3")
library(ggplot2)
download_file_name <- 'https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip'
raw_data_file_name <- 'W3.Project2.Data.zip'
if(!file.exists(raw_data_file_name)) {
download.file(download_file_name, destfile=raw_data_file_name, method='curl')
unzip(raw_data_file_name)
data_file_name <- 'summarySCC_PM25.rds'
code_file_name <- 'Source_Classification_Code.rds'
NEI <- readRDS(data_file_name)
SCC <- readRDS(code_file_name)
} else {
print("Data downloaded and extracted. Check NEI and SCC for data records.")
}
# pop this sucker int a data table for easy grouping
library(data.table)
library(xts)
NEI_DT <- data.table(NEI)
# get list of ids for sectors that have motor Vehicles
SCC_vehicles_id_list <- SCC[grepl("Vehicles", SCC$EI.Sector, ignore.case=TRUE),"SCC"]
# filter the emissions data based on those ids in Baltimore
baltimore_vs_lac_emissions_for_vehicles <- NEI_DT[NEI_DT$SCC %in% SCC_vehicles_id_list & NEI_DT$fips %in% c("06037","24510"),]
# use data.table to group by year summing the total Emissions
baltimore_vs_lac_emissions_for_vehicles_by_year <- baltimore_vs_lac_emissions_for_vehicles[,list(Emissions=sum(Emissions)), by=c('year','fips')]
# lets put some rational names on the data instead of the fips number =P
baltimore_vs_lac_emissions_for_vehicles_by_year$fips_name <- unlist(lapply(baltimore_vs_lac_emissions_for_vehicles_by_year$fips, function(x) if (x == "06037") {"Los Angeles County"} else {"Baltimore"}))
## Question 6: Compare emissions from motor vehicle sources in Baltimore City with emissions from motor
## vehicle sources in Los Angeles County, California (fips == "06037").
## Which city has seen greater changes over time in motor vehicle emissions?
# save it to a 480x720 pixel png file
small_data_png_file_name = "plot6.png"
png(height=480, width=720, file=small_data_png_file_name)
g1 <- ggplot(baltimore_vs_lac_emissions_for_vehicles_by_year, aes(x=year, y=Emissions)) + geom_point()
g1 +
scale_y_log10() +
facet_grid(fips_name ~ .) +
geom_smooth(method=lm) +
ggtitle(expression("Relative Total PM"[2.5]*" vehicle Emissions in Baltimore vs Los Angeles County from 1999-2008")) +
ylab(expression("Total Emissions (PM"[2.5]*') *log scale'))
# close png file
dev.off()
## Answer It appears that Baltimore had the greatest change. It decreased by a larger ammount in relative terms to the Los Angeles County increase.
## To show this easily I graphed each to log scale as the absolute change in Los Angeles County was greater, but it's percentage change was smaller.
